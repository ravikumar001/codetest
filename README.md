some more changes to code

tests
